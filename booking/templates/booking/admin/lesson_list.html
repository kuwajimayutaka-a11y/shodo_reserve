{% extends "base.html" %}

{% block title %}授業枠一覧{% endblock %}

{% block content %}
<h2>授業枠一覧</h2>

<div style="margin-bottom: 20px;">
    <a href="{% url 'admin_dashboard' %}" style="color: #007bff; text-decoration: none;">← 管理者ダッシュボードに戻る</a>
</div>

<div style="margin-bottom: 20px;">
    <a href="{% url 'admin_create_lesson_slots' %}" style="padding: 10px 20px; background-color: #007bff; color: white; text-decoration: none; border-radius: 4px; display: inline-block;">+ 授業枠を一括作成</a>
</div>

{% if messages %}
    {% for message in messages %}
        <div style="padding: 10px; margin: 10px 0; background-color: {% if message.tags == 'success' %}#d4edda{% elif message.tags == 'error' %}#f8d7da{% else %}#d1ecf1{% endif %}; border: 1px solid {% if message.tags == 'success' %}#c3e6cb{% elif message.tags == 'error' %}#f5c6cb{% else %}#bee5eb{% endif %}; border-radius: 4px;">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

{% if lessons %}
    <div style="margin-top: 20px; overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse; background-color: white;">
            <thead>
                <tr style="background-color: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                    <th style="padding: 12px; text-align: left; color: #495057; font-weight: 600;">授業名</th>
                    <th style="padding: 12px; text-align: left; color: #495057; font-weight: 600;">開始日時</th>
                    <th style="padding: 12px; text-align: left; color: #495057; font-weight: 600;">終了日時</th>
                    <th style="padding: 12px; text-align: center; color: #495057; font-weight: 600;">定員</th>
                    <th style="padding: 12px; text-align: center; color: #495057; font-weight: 600;">予約数</th>
                    <th style="padding: 12px; text-align: center; color: #495057; font-weight: 600;">操作</th>
                </tr>
            </thead>
            <tbody>
                {% for lesson in lessons %}
                <tr style="border-bottom: 1px solid #dee2e6;">
                    <td style="padding: 12px;">
                        <strong>{% if lesson.title %}{{ lesson.title }}{% else %}書道教室{% endif %}</strong>
                    </td>
                    <td style="padding: 12px;">{{ lesson.start_time|date:"Y/m/d H:i" }}</td>
                    <td style="padding: 12px;">{{ lesson.end_time|date:"Y/m/d H:i" }}</td>
                    <td style="padding: 12px; text-align: center;">{{ lesson.capacity }}</td>
                    <td style="padding: 12px; text-align: center;">
                        <span style="padding: 4px 8px; background-color: {% if lesson.available_slots > 0 %}#d4edda{% else %}#f8d7da{% endif %}; border-radius: 4px; color: {% if lesson.available_slots > 0 %}#155724{% else %}#721c24{% endif %};">
                            {{ lesson.reservation_set.count }}
                        </span>
                    </td>
                    <td style="padding: 12px; text-align: center;">
                        <a href="{% url 'admin_edit_lesson_slot' lesson.id %}" style="padding: 6px 12px; background-color: #007bff; color: white; text-decoration: none; border-radius: 4px; margin-right: 5px; display: inline-block; font-size: 0.9em;">編集</a>
                        <a href="{% url 'admin_delete_lesson_slot' lesson.id %}" style="padding: 6px 12px; background-color: #dc3545; color: white; text-decoration: none; border-radius: 4px; display: inline-block; font-size: 0.9em;">削除</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% else %}
    <div style="margin-top: 20px; padding: 20px; background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; text-align: center; color: #6c757d;">
        <p>授業枠がありません。</p>
        <a href="{% url 'admin_create_lesson_slots' %}" style="color: #007bff; text-decoration: none;">授業枠を作成してください</a>
    </div>
{% endif %}
{% endblock %}
