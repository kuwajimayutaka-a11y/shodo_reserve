{% extends "base.html" %}

{% block title %}予約一覧{% endblock %}

{% block content %}
<h2>予約一覧</h2>

<div style="margin-bottom: 20px;">
    <a href="{% url 'admin_dashboard' %}" style="color: #007bff; text-decoration: none;">← 管理者ダッシュボードに戻る</a>
</div>

{% if messages %}
    {% for message in messages %}
        <div style="padding: 10px; margin: 10px 0; background-color: {% if message.tags == 'success' %}#d4edda{% elif message.tags == 'error' %}#f8d7da{% else %}#d1ecf1{% endif %}; border: 1px solid {% if message.tags == 'success' %}#c3e6cb{% elif message.tags == 'error' %}#f5c6cb{% else %}#bee5eb{% endif %}; border-radius: 4px;">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

{% if reservations %}
    <div>
        {% for date, lessons in lessons_by_date %}
            <div style="margin-bottom: 20px;">
                {% for lesson in lessons %}
                    {% if lesson.reservation_set.all %}
                        <div class="reservation-card">
                            <h4>{{ lesson.title|default:"書道教室" }} - {{ lesson.start_time|date:"Y年m月d日 H:i" }}</h4>
                            <div class="reservation-list">
                                {% for reservation in lesson.reservation_set.all %}
                                    <div class="reservation-item">
                                        <div><strong>{{ reservation.student.name }}</strong> (<span style="color: #6c757d;">{{ reservation.student.family.user.username }}</span>)</div>
                                        <a href="{% url 'admin_cancel_reservation' reservation.id %}" class="cancel-btn">キャンセル</a>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        {% empty %}
            <p style="color: #6c757d;">予約済みの授業はありません。</p>
        {% endfor %}
    </div>
{% else %}
    <div style="margin-top: 20px; padding: 20px; background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 4px; text-align: center; color: #6c757d;">
        <p>予約がありません。</p>
    </div>
{% endif %}
{% endblock %}
